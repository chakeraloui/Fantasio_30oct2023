-- Gérer la présence de fréquences à 0, 1, ou manquantes quand 
   on utilise un panel de référence

-- Les fréquences alléliques devraient être un argument de Fantasio
   (avec valeur par défaut x@p...)

-- dans @segments_list on a une liste de 22 élts, chacune pour un chr,
   chacun de ces élts est une liste de vecteurs du type n:m 
   -> pas besoin de séparer les chromosomes ;
   -> pas besoin de stocker n:m, c(n,m) suffit
   --> modifier non seulement la fonction de création de segments_lists
       mais les fonctions qui l'utilisent

   concernant les 'segments list by distance' on a ajouté des commentaires
   dans la branche 'margot' dans getMarkerChromosomByDistance.r / select.marker.downstream.r

-- est-ce que dans les élts de @submaps_list (qui sont des HotspotsMatrix)
   il n'y a pas un peu trop d'information ? (il y a @submap, qui permet de
   retrouver @map, est-ce nécessaire de le conserver ? le @ped est juste une
   référence mais est-il utile ?)
   Possibilité d'alléger les objets @HBD.prob et @FLOD (nom de col et ligne ?)

-- setSummary renvoie un warning : "No individual with pheno = 2"
   Est-ce que les phénotypes ne sont pas 0/1 ?
   La fonction pourrait décider selon ce qu'elle voit.
   --> après discussion plutôt inclure un argument du genre 
       phen.code = "R" ou "plink"  (resp 0/1/NA et 1/2/0)

-- Avec verbose == TRUE, éviter le défilement (backspace \b ou retour chariot \r)
Estimation f and a for individual # 39 
Estimation f and a for individual # 40 
etc

-- Fantasio n'aime pas :
   * que les identifiants des chr ne soient pas numériques 
     (fonctions graphiques)
   * que les phénotypes soient 'NA' (calcul des FLOD ...)
   --> vérifier au début.

-- list.id = "all" : petit problème sématique
   + pb de warning lors du test (list.id == "all")

-- pourquoi la vignette ne s'installe pas ?

-- methode Summary pour les objets de classe "atlas" 
   -> afficher le @submap_summary (s'il existe)

-- chasser les incohérences entre famid/id, FID/IID, family/individual (etc ?)
   (fonction pour changer les noms de colonne dans les données ROH de plink ?)

-- TOUT TESTER QUAND IL N'Y A QU'UN CHR OU LES CHRs 8 10 PAR EX.

-- dans la vignette, illustrer l'utilisation d'un fichier de ROH
   générés par plink

-- dans les fonctions de plot HBD ajouter bande grise un individu
   sur deux / ou bien une ligne par individu, pour rendre le plot
   plus lisible

-- rassembler la doc des classes et méthodes en une seule page

-- setAllelicFrequencies -- peut-être pas la meilleure solution
   à revoir ...
   [ Il serait bcp plus intéressant qu'elle fasse le petit grigri
     cité dans ~/DATA/DataXP/ ]

-- revoir le jeu de données cytobands pour les chr acrocentriques
 
-- est-ce tout ce qui est exporté est illustré dans la vignette ?

!! j'ai supprimé l'argument run_a_f dans setSummary
!! ---> verifier ce qui se passe si festim n'a pas tourné

-- envisager fonction pour les ROH



********************************************************
26/01/2018
********************************************************
*arret des tests à l'étape 3 (de la documentation) pour les tests
* HFLOD par segment
* plot ind 1 = y1; plot ind 2 = y2
* faire comparaison entre FSuite et FEstim par SNPs
* revoir la délimitation d'un segment pour HBD_segments


********************************************************
old chunks of TODO
********************************************************

* dans fonction festim ajouter au data frame res les colonnes famid et id
* dans forward_backward girer les cas f == 0 et f == 1 de la meme fagon que dans Likelihood ... !
* calcul (approche) de la hessienne en (a,f)
* jeter un oeil sur la fonction festim / choix d'optimisation ...
* dans festim() modifier test pour appel set.log.emiss (penser aux msat matrix crees avec une sous carte)
* traiter le cas des warnings causer par le fait qu'on donne une matrice vide en argument de msat.msatrix lors de la création des sous-cartes
* ajouter la carte génétique au fichier plink.bim (boucle sur les chromosomes id utilisés
    for(i in 1:22)
    {
      plink2 --bfile plink --cm-map   ....projg4/Maps/genetic_map_b37/genetic_map_chr${i}_combined_b37.txt    $i    --make-bed
    }
* modifier la borne de a dans festim (trop élevé)

* créer fonction mating type
* gérer les fratries 
* HFLOD seulement sur les individus consanguins( INBRED == TRUE)


